var H=Object.defineProperty;var O=(o,e,t)=>e in o?H(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var a=(o,e,t)=>(O(o,typeof e!="symbol"?e+"":e,t),t);import{d as y,j as P,E as R,a as F,o as n,c as _,e as v,t as M,u as r,g as m,h as C,n as D,F as k,f as A,b as G,A as L,q as S,G as $,k as I}from"./vue.esm-bundler-cac5f4b7.js";import{V as K}from"./VrxSelect-1982c952.js";import{V as j}from"./VrxInput-84905bee.js";import{V as U}from"./VrxIcon-940abacc.js";import{_ as b}from"./_plugin-vue_export-helper-c27b6911.js";import{c as x}from"./styles-afa5fe0e.js";import{_ as W}from"./VrxButton.vue_vue_type_script_setup_true_lang-7349bfe9.js";/* empty css                                                                  */import"./_commonjsHelpers-042e6b4d.js";class q{constructor(e){a(this,"_id");a(this,"_text");a(this,"_type");a(this,"_align");a(this,"_sortable");a(this,"_sortFunction");a(this,"_sortDirection");a(this,"_width");a(this,"_filterType");a(this,"_filterPlaceholder");a(this,"_customFilter");a(this,"_headerConfig");this._id=e.id,this._text=e.text,this._type=e.type,this._align=e.align,this._sortable=e.sortable,this._sortFunction=e.sortFunction,this._sortDirection=e.sortDirection,this._width=e.width,this._filterType=e.filterType,this._filterPlaceholder=e.filterPlaceholder,this._customFilter=e.customFilter,this._headerConfig=e}get id(){return this._id}get text(){return this._text}get filterType(){return this._filterType??null}get filterPlaceholder(){return this._filterPlaceholder??null}get sortable(){return this._sortable??!1}get sortDirection(){return this._sortDirection??null}get textAlignmentClass(){switch(this._align){case"left":return"text-left";case"center":return"text-center";case"right":return"text-right";default:return null}}get width(){return this._width}sortClicked(e){this._sortable&&(this._sortDirection=this._sortDirection==="asc"?"desc":"asc",this._headerConfig.sortDirection=this._sortDirection,this._resetSortDirection(e,[this._id]),this._sortFunction?this._useCustomSorting(e):this._useDefaultSorting(e))}_useDefaultSorting(e){e.data.sort((t,i)=>t.data[this._id]<i.data[this._id]?this._sortDirection==="asc"?1:-1:t.data[this._id]>i.data[this._id]?this._sortDirection==="asc"?-1:1:0)}_useCustomSorting(e){this._sortFunction&&e&&e.data.sort(this._sortFunction)}_resetSortDirection(e,t=[]){e.header.forEach(i=>{t.includes(i.id)||(i.sortDirection=void 0)})}getSelectableItems(e){const t=[];return e.data.forEach(i=>{t.find(l=>l.value===i.data[this._id])||t.push({value:i.data[this._id],label:i.data[this._id]})}),t.sort((i,l)=>i.label.localeCompare(l.label))}filterByValue(e,t){const i=e.find(l=>l.cellId===this._id);i&&t===""&&e.splice(e.indexOf(i),1),i?i.value=t:e.push({cellId:this._id,value:t})}}const J={class:"vrx-grid-label"},Q=y({__name:"VrxGridHeaderCell",props:{gridConfig:{},headerConfig:{}},setup(o){const e=o;P(f=>({b3f6c4f0:r(s).width+"px"}));const t=R("filters");let i=F(""),l=F([]);const s=new q(e.headerConfig);return(f,h)=>(n(),_("th",{scope:"col",class:D(["px-3 py-3 vrx-th header-th",r(s).textAlignmentClass])},[v("div",{class:"vrx-header-cell mb-2",onClick:h[0]||(h[0]=g=>r(s).sortClicked(e.gridConfig))},[v("span",J,M(r(s).text),1),r(s).sortable?(n(),m(U,{key:0,icon:f.headerConfig.sortDirection==="asc"?"chevron-up":f.headerConfig.sortDirection==="desc"?"chevron-down":"empty",size:"3"},null,8,["icon"])):C("",!0)]),r(s).filterType==="text"?(n(),m(j,{key:0,"model-value":r(i),height:30,class:"header-input",placeholder:r(s).filterPlaceholder??"...",type:"text",onInput:h[1]||(h[1]=g=>r(s).filterByValue(r(t),g.target.value))},null,8,["model-value","placeholder"])):C("",!0),r(s).filterType==="select"?(n(),m(K,{key:1,"list-data":r(s).getSelectableItems(f.gridConfig),"model-value":r(l),placeholder:r(s).filterPlaceholder??"...",class:"header-input",height:30,"on-select":g=>r(s).filterByValue(r(t),g.value),"on-clear":()=>r(s).filterByValue(r(t),"")},null,8,["list-data","model-value","placeholder","on-select","on-clear"])):C("",!0)],2))}});const X=b(Q,[["__scopeId","data-v-2a41578c"]]),Y={"data-testid":"vrx-grid-header",class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400 vrx-table"},Z=y({__name:"VrxGridHeader",props:{gridConfig:{}},setup(o){return(e,t)=>(n(),_("thead",Y,[v("tr",null,[(n(!0),_(k,null,A(e.gridConfig.header,i=>(n(),m(X,{"grid-config":e.gridConfig,"header-config":i},null,8,["grid-config","header-config"]))),256))])]))}});const ee=b(Z,[["__scopeId","data-v-4e05e236"]]),te={left:"text-left",right:"text-right",center:"text-center"};class se{constructor(e,t,i,l,s,f){a(this,"_id");a(this,"_textColor");a(this,"_backgroundColor");a(this,"_data");a(this,"_filters");a(this,"_selectedRows");a(this,"_selectable");a(this,"_multiselect");a(this,"_headerConfig");this._id=e.id,this._textColor=e.textColor,this._backgroundColor=e.backgroundColor,this._data=e.data,this._filters=t,this._selectedRows=i,this._selectable=l,this._multiselect=s,this._headerConfig=f}getCellContent(e){return this._data[e]}get textColor(){return this._textColor}get backgroundColor(){return this._backgroundColor}get id(){return this._id}get data(){return this._data}get selectable(){return this._selectable}rowClicked(){const e=this._selectedRows.find(t=>t.id===this._id);if(!this._multiselect){if(e){const t=this._selectedRows.indexOf(e);this._selectedRows.splice(t,1);return}this._selectedRows.splice(0,this._selectedRows.length),this._selectedRows.push(this);return}if(!e)this._selectedRows.push(this);else{const t=this._selectedRows.indexOf(e);this._selectedRows.splice(t,1)}}isFiltered(){let e=!1;return this._filters.forEach(t=>{var l;const i=(l=this._headerConfig.find(s=>s.id===t.cellId))==null?void 0:l.customFilter;e||(e=i?i(this,t):this._defaultFilter(t))}),e}isSelected(){return!!this._selectedRows.find(t=>t.id===this._id)}_defaultFilter(e){return!this._data[e.cellId].toString().includes(e.value)}}const ie=["data-testid"],re={key:0,class:"vrx-grid-cell-content"},le=y({__name:"VrxGridRow",props:{row:{},headerConfig:{},selectable:{type:Boolean},multiselect:{type:Boolean}},setup(o){const e=o;P(h=>({a0fc9aa0:r(x).blue[500],"044164cb":r(x).gray[100],bbdfdfc8:r(l).textColor,"2819543b":r(l).backgroundColor,"0441d92a":r(x).gray[200],"04441f05":r(x).gray[700],"0443aaa6":r(x).gray[600]}));const t=R("filters"),i=R("selectedRows"),l=new se(e.row,t,i,e.selectable??!1,e.multiselect??!1,e.headerConfig),s=G(()=>l.isFiltered()),f=G(()=>l.selectable?l.isSelected()?"selected row-hover dark:selected dark:row-hover dark:bg-gray-100":"not-selected dark:row-hover row-hover dark:bg-gray-100":"not-selected");return(h,g)=>s.value?C("",!0):(n(),_("tr",{key:0,"data-testid":"vrx-grid-row-"+r(l).id,class:D(["bg-white border-b dark:bg-gray-800 dark:border-gray-700 vrx-row",f.value]),onClick:g[0]||(g[0]=p=>r(l).rowClicked())},[(n(!0),_(k,null,A(h.headerConfig,p=>(n(),_("td",{class:D(["px-3 py-4 font-medium whitespace-nowrap vrx-cell",p.align?r(te)[p.align]:null])},[!p.type||p.type==="text"?(n(),_("span",re,M(r(l).getCellContent(p.id)),1)):(n(),m(L(h.row.data[p.id]),{key:1}))],2))),256))],10,ie))}});const ae=b(le,[["__scopeId","data-v-ffc133ef"]]),oe={style:{"overflow-y":"scroll"}},ne=y({__name:"VrxGridBody",props:{modelValue:{}},setup(o){return(e,t)=>(n(),_("tbody",oe,[(n(!0),_(k,null,A(e.modelValue.data,i=>(n(),m(ae,{row:i,"header-config":e.modelValue.header,key:i.id,selectable:e.modelValue.selectable,multiselect:e.modelValue.multiselect},null,8,["row","header-config","selectable","multiselect"]))),128))]))}});const de=b(ne,[["__scopeId","data-v-88e84425"]]);class ce{constructor(e){a(this,"_configuration");a(this,"_filters");a(this,"_selectedRows");this._configuration=e,this._filters=S([]),this._selectedRows=S([])}get configuration(){return this._configuration}get filters(){return this._filters}get data(){return this._configuration.data}get selectedRows(){return this._selectedRows}set filters(e){this.deselectAll(),this._filters=e}set selectedRows(e){this._selectedRows=e}selectAll(){if(this._configuration.multiselect===!1){console.warn(`Multiselection in grid "${this._configuration.id}" is disabled. No rows will be selected`);return}this.deselectAll(),this._configuration.data.forEach(e=>{this._selectedRows.push(e)})}deselectAll(){this._selectedRows.splice(0,this._selectedRows.length)}resetFilters(){this._filters.splice(0,this._filters.length)}clearData(){this.deselectAll(),this.resetFilters(),this._configuration.data.splice(0,this._configuration.data.length)}updateData(e){e.forEach(t=>{const i=this._configuration.data.find(l=>l.id===t.id);if(i){const l=this._configuration.data.indexOf(i);this._configuration.data.splice(l,1),this._configuration.data.splice(l,0,t)}else this._configuration.data.push(t)})}setData(e){this.clearData(),this._configuration.data.splice(0,this._configuration.data.length),e.forEach(t=>{this._configuration.data.push(t)})}selectRange(e,t){let i=e,l=t;e>t&&(i=t,l=e),this._filters.splice(0,this._filters.length),this.deselectAll();for(let s=i;s<=l;s++)this._selectedRows.push(this._configuration.data[s])}}const ue={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},_e=y({__name:"VrxGrid",props:{gridConfiguration:{}},setup(o,{expose:e}){const t=o,i=d=>{(d.ctrlKey||d.metaKey)&&d.key==="a"&&(d.preventDefault(),s.selectAll())},l=d=>{if(d.shiftKey&&s.configuration.multiselect){d.preventDefault();const c=s.selectedRows.length;if(c>=2){let u=s.data.find(V=>V.id===s.selectedRows[0].id),B=s.data.find(V=>V.id===s.selectedRows[c-1].id);u&&B&&s.selectRange(s.data.indexOf(u),s.data.indexOf(B))}}},s=new ce(t.gridConfiguration);return $("filters",s.filters),$("selectedRows",s.selectedRows),e({getSelectedRows:()=>s.selectedRows,getFilters:()=>s.filters,setData:d=>{s.setData(d)},resetFilters:()=>{s.resetFilters()},deselectAll:()=>{s.deselectAll()},selectAll:()=>{s.selectAll()},clearData:()=>{s.clearData()},updateData:d=>{s.updateData(d)},selectRange:(d,c)=>{s.selectRange(d,c)}}),(d,c)=>(n(),_("div",{"data-testid":"vrx-grid",onKeydown:c[2]||(c[2]=u=>i(u)),onClick:c[3]||(c[3]=u=>l(u)),class:"table-outline relative overflow-x-auto h-full shadow-md w-full rounded-lg bg-white dark:bg-gray-800",tabindex:"1"},[v("table",ue,[I(ee,{"grid-config":r(s).configuration,"onUpdate:gridConfig":c[0]||(c[0]=u=>r(s).configuration=u)},null,8,["grid-config"]),I(de,{modelValue:r(s).configuration,"onUpdate:modelValue":c[1]||(c[1]=u=>r(s).configuration=u)},null,8,["modelValue"])])],32))}});const z=b(_e,[["__scopeId","data-v-c0b2606b"]]),Be={title:"VrxGrid",component:z,tags:["autodocs"],argTypes:{}},fe={render:o=>({components:{VrxGrid:z,VrxButton:W},setup(){return{args:o}},methods:{logItem(){alert(this.$refs.myRef.getSelectedRows().map(e=>e.data.name).join(", "))},setData(e){this.$refs.myRef.setData(e)},selectAll(){this.$refs.myRef.selectAll()},deselectAll(){this.$refs.myRef.deselectAll()},updateData(e){this.$refs.myRef.updateData(e)},clearData(){this.$refs.myRef.clearData()}},template:`
          <VrxGrid v-bind="args" ref="myRef" :grid-configuration="args.gridConfiguration" style="height: 500px"/>

          <div style="padding-top: 30px; display: flex; flex-direction: row; gap: 5px">
              <VrxButton color="default" size="sm" @click="logItem" >Log selected items</VrxButton>
              <VrxButton color="default" size="sm" @click="setData(
                  [{ data: {name: 'Maria Rosa',serialNumber: 6,color: 'Black',model: 'Audi',plate: 'AA123BC'},id: '6'}])">Set Data</VrxButton>
              <VrxButton color="default" size="sm" @click="updateData(
                  [{id: '2', data: {name: 'Ilary Blasi',serialNumber: 10,color: 'Blue',model: 'BMW',plate: 'AA123BC'}}])">Update Data</VrxButton>
              <VrxButton color="default" size="sm" @click="clearData">Clear Data</VrxButton>
              <VrxButton color="default" size="sm" @click="selectAll">Select All</VrxButton>
              <VrxButton color="default" size="sm" @click="deselectAll">Deselect All</VrxButton>
          </div>
        `}),args:{gridConfiguration:{id:"test",selectable:!0,multiselect:!0,header:[{text:"Name",id:"name",align:"left",sortable:!0,type:"text",filterType:"text",filterPlaceholder:"Search by name",width:150},{text:"Serial Number",id:"serialNumber",align:"left",sortable:!0,filterType:"text",width:150},{text:"Color",id:"color",align:"left",sortable:!0,filterType:"select",width:150},{text:"Model",id:"model",align:"left",sortable:!0,filterType:"select",width:150},{text:"Plate",id:"plate",align:"left",sortable:!0,filterType:"text",width:150}],data:[{id:"1",data:{name:"Mario Rossi",serialNumber:1,color:"Red",model:"Fiat",plate:"AA123AA"}},{id:"2",data:{name:"Pino Verdi",serialNumber:2,color:"Black",model:"Audi",plate:"AA123BB"}},{id:"3",data:{name:"Ciro Bianchi",serialNumber:3,color:"Green",model:"BMW",plate:"AA123CC"}},{id:"4",data:{name:"Luisa Neri",serialNumber:4,color:"Gray",model:"Renault",plate:"AA123DD"}},{id:"5",data:{name:"Giovanni Gialli",serialNumber:5,color:"Gray",model:"Toyota",plate:"BC123EE"}}]}}},w={...fe};var T,N,E;w.parameters={...w.parameters,docs:{...(T=w.parameters)==null?void 0:T.docs,source:{originalSource:`{
  ...Template
}`,...(E=(N=w.parameters)==null?void 0:N.docs)==null?void 0:E.source}}};const Fe=["Primary"];export{w as Primary,Fe as __namedExportsOrder,Be as default};
//# sourceMappingURL=VrxGrid.stories-4fcf77a1.js.map
